<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gold App - Converter</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body onload="loadTheme(); setupBackspace();">

<div class="app-container">
    <div class="header">
        <div class="menu-icon" onclick="toggleMenu()">☰</div>
        <img src="logo.png" alt="Logo" class="logo-img">
        <div style="width:40px;"></div>
    </div>

    <div id="menuPopup">
        <a href="rate.html" class="menu-btn">Rate F</a>
        <a href="converter.html" class="menu-btn" style="background:#ddd;">Weight Converter</a>
        <a href="settings.html" class="menu-btn">Settings</a>
        <a href="index.html" class="menu-btn">Casio Calculator</a>
    </div>

    <div class="scrollable-page active">
        <div class="card" style="text-align:center;">
            <h4 style="color:var(--primary); margin-bottom:15px; letter-spacing:2px; font-weight:900;">WEIGHT CONVERTER</h4>
            <input type="text" inputmode="none" readonly id="cv_g" class="main-input" placeholder="Grams" onclick="focusField(this)">
            <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; margin:20px 0;">
                <div class="conv-box"><input type="text" inputmode="none" readonly id="res_v" class="conv-inp" placeholder="0" onclick="focusField(this)"><span class="conv-lbl">Vori</span></div>
                <div class="conv-box"><input type="text" inputmode="none" readonly id="res_a" class="conv-inp" placeholder="0" onclick="focusField(this)"><span class="conv-lbl">Ana</span></div>
                <div class="conv-box"><input type="text" inputmode="none" readonly id="res_r" class="conv-inp" placeholder="0" onclick="focusField(this)"><span class="conv-lbl">Ratti</span></div>
            </div>
            <button class="btn-action" onclick="downloadReport()">DOWNLOAD REPORT</button>
        </div>
    </div>
</div>

<div id="customKeypad">
    <button class="k-btn k-close" onclick="closeKeypad()">Done ▼</button>
    <div class="keypad-grid">
        <button class="k-btn" onclick="press('1')">1</button>
        <button class="k-btn" onclick="press('2')">2</button>
        <button class="k-btn" onclick="press('3')">3</button>
        <button class="k-btn" onclick="press('4')">4</button>
        <button class="k-btn" onclick="press('5')">5</button>
        <button class="k-btn" onclick="press('6')">6</button>
        <button class="k-btn" onclick="press('7')">7</button>
        <button class="k-btn" onclick="press('8')">8</button>
        <button class="k-btn" onclick="press('9')">9</button>
        <button class="k-btn" onclick="press('.')">.</button>
        <button class="k-btn" onclick="press('0')">0</button>
        <button class="k-btn" id="btn-back" style="color:#ff4d4d;">⌫</button>
    </div>
</div>

<script src="js/common.js"></script>
<script src="js/pdfHelper.js"></script>
<script>
    // Converter Logic
    function press(key) {
        if(!activeInput) return;
        if(key === 'back') activeInput.value = activeInput.value.slice(0, -1);
        else { if(key === '.' && activeInput.value.includes('.')) return; activeInput.value += key; }
        
        if(activeInput.id === 'cv_g') gToV(); else vToG();
    }

    function gToV() {
        let g = parseFloat(document.getElementById('cv_g').value) || 0;
        let tb = g / 11.664, v = Math.floor(tb), rem = tb - v, a = Math.floor(rem * 16), r = ((rem * 16) - a) * 6;
        document.getElementById('res_v').value = v; document.getElementById('res_a').value = a; document.getElementById('res_r').value = r.toFixed(2);
    }

    function vToG() {
        let v = parseFloat(document.getElementById('res_v').value) || 0, a = parseFloat(document.getElementById('res_a').value) || 0, r = parseFloat(document.getElementById('res_r').value) || 0;
        document.getElementById('cv_g').value = ((v + (a/16) + (r/96)) * 11.664).toFixed(3);
    }

    function downloadReport() {
        let content = `<div style="padding:20px;"><h3>Grams: ${document.getElementById('cv_g').value}</h3><p>Vori: ${document.getElementById('res_v').value} | Ana: ${document.getElementById('res_a').value}</p></div>`;
        generatePDF('Weight Report', content);
    }
</script>
</body>
</html>
