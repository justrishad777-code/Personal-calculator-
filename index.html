<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Dashboard</title>
    
    <link rel="manifest" href="manifest.json">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dashboard">
    <link rel="apple-touch-icon" href="logo.png">
    
    <meta name="theme-color" content="#1a1d24">

    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- DARK COMFORT THEME VARIABLES --- */
        :root { 
            --primary: #ffaf40;    /* Soft Orange */
            --secondary: #48dbfb;  /* Soft Blue */
            --accent: #1dd1a1;     /* Soft Green */
            --bg-color: #222831;   /* Dark Background */
            --card-bg: #393e46;    /* Card Background */
            --text-main: #eeeeee;  /* Main Text */
            --text-muted: #adb5bd; /* Muted Text */
            --border: #4b5563;     /* Border Color */
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; padding: 0; 
            font-family: 'Segoe UI', sans-serif; 
            background: var(--bg-color); 
            color: var(--text-main);
            display: flex; flex-direction: column; height: 100vh;
            /* Safe area for iPhone Notch */
            padding-top: env(safe-area-inset-top); 
        }

        /* HEADER */
        .header {
            height: 60px; background: #1a1d24; 
            display: flex; align-items: center; padding: 0 20px;
            border-bottom: 1px solid #333; justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3); z-index: 100;
        }
        .menu-icon { font-size: 24px; cursor: pointer; color: #fff; }
        .app-title { font-size: 20px; font-weight: bold; letter-spacing: 0.5px; }
        .logo-img { height: 35px; }

        /* MENU POPUP */
        #menuPopup {
            display: none; position: absolute; top: 60px; left: 10px; width: 220px;
            background: var(--card-bg); border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 2000; flex-direction: column; border: 1px solid #555; overflow: hidden;
        }
        .menu-item { 
            padding: 15px; text-decoration: none; color: #eee; 
            border-bottom: 1px solid #555; font-weight: 600; display: flex; align-items: center; 
            transition: 0.2s; cursor: pointer;
        }
        .menu-item:hover { background: #444; padding-left: 20px; }
        .menu-icon-span { margin-right: 12px; font-size: 18px; }

        /* INSTALL BUTTON STYLE */
        #installBtn {
            display: none; /* Hidden by default */
            background: var(--primary);
            color: #1a1d24;
            border: none;
        }
        #installBtn:hover { background: #ff9f1a; }

        /* DASHBOARD CONTENT */
        .content {
            flex: 1; padding: 25px; overflow-y: auto;
            display: flex; flex-direction: column; gap: 20px;
        }

        .welcome-text { font-size: 14px; color: var(--text-muted); margin-bottom: 5px; }
        .user-name { font-size: 28px; font-weight: bold; color: #fff; margin-bottom: 20px; }

        /* DASHBOARD CARDS */
        .dash-card {
            background: var(--card-bg); border-radius: 16px; padding: 25px;
            display: flex; align-items: center; justify-content: space-between;
            text-decoration: none; color: inherit;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 1px solid transparent; transition: transform 0.2s, border-color 0.2s;
        }
        .dash-card:active { transform: scale(0.98); }

        /* Card Colors */
        .card-rate { border-left: 5px solid var(--primary); }
        .card-conv { border-left: 5px solid var(--secondary); }
        .card-calc { border-left: 5px solid var(--accent); }
        .card-set { border-left: 5px solid #a5b1c2; }

        .card-icon {
            font-size: 32px; width: 60px; height: 60px;
            background: rgba(255,255,255,0.05); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
        }
        .card-info { flex: 1; margin-left: 20px; }
        .card-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; display: block; }
        .card-desc { font-size: 13px; color: var(--text-muted); }
        .arrow { font-size: 20px; color: #666; }

    </style>
    <link rel="icon" type="image/png" href="logo.png">
</head>
<body>

    <div class="header">
        <div class="menu-icon" onclick="toggleMenu()">‚ò∞</div>
        <span class="app-title">Dashboard</span>
        <img src="logo.png" alt="Logo" class="logo-img">
    </div>

    <div id="menuPopup">
        <button id="installBtn" class="menu-item"><span class="menu-icon-span">‚¨áÔ∏è</span> Install App</button>
        
        <a href="index.html" class="menu-item" style="background:#444;"><span class="menu-icon-span">üè†</span> Dashboard</a>
        <a href="rate_new.html" class="menu-item"><span class="menu-icon-span">üìù</span> Rate F</a>
        <a href="converter.html" class="menu-item"><span class="menu-icon-span">‚öñÔ∏è</span> Converter</a>
        <a href="casio.html" class="menu-item"><span class="menu-icon-span">üî¢</span> Casio Calc</a>
        <a href="settings.html" class="menu-item"><span class="menu-icon-span">‚öôÔ∏è</span> Settings</a>
    </div>

    <div class="content">
        <div>
            <div class="welcome-text">Welcome back,</div>
            <div class="user-name">Rishad</div>
        </div>

        <a href="rate_new.html" class="dash-card card-rate">
            <div class="card-icon" style="color:var(--primary);">üìù</div>
            <div class="card-info">
                <span class="card-title">Rate F</span>
                <span class="card-desc">Calculate Gold Rates & Invoice</span>
            </div>
            <div class="arrow">‚ûî</div>
        </a>

        <a href="converter.html" class="dash-card card-conv">
            <div class="card-icon" style="color:var(--secondary);">‚öñÔ∏è</div>
            <div class="card-info">
                <span class="card-title">Converter</span>
                <span class="card-desc">Vori to Gram & Gram to Vori</span>
            </div>
            <div class="arrow">‚ûî</div>
        </a>

        <a href="casio.html" class="dash-card card-calc">
            <div class="card-icon" style="color:var(--accent);">üî¢</div>
            <div class="card-info">
                <span class="card-title">Calculator</span>
                <span class="card-desc">Casio Style Calculation</span>
            </div>
            <div class="arrow">‚ûî</div>
        </a>
        
        <a href="settings.html" class="dash-card card-set">
            <div class="card-icon" style="color:#a5b1c2;">‚öôÔ∏è</div>
            <div class="card-info">
                <span class="card-title">Settings</span>
                <span class="card-desc">App Configuration</span>
            </div>
            <div class="arrow">‚ûî</div>
        </a>
    </div>

    <script>
        // 1. REGISTER SERVICE WORKER (Critical for PWA)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(reg => console.log('Service Worker Registered'))
                    .catch(err => console.log('Service Worker Failed', err));
            });
        }

        // 2. MENU LOGIC
        function toggleMenu() {
            const m = document.getElementById('menuPopup');
            m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
        } 

        // Close menu if clicked outside
        window.addEventListener('click', function(e) {
            const m = document.getElementById('menuPopup');
            const btn = document.querySelector('.menu-icon');
            if (e.target !== m && e.target !== btn && !m.contains(e.target)) {
                m.style.display = 'none';
            }
        });

        // 3. INSTALLATION LOGIC
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'flex'; 

            installBtn.addEventListener('click', (e) => {
                installBtn.style.display = 'none';
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the A2HS prompt');
                    } else {
                        console.log('User dismissed the A2HS prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });
    </script>

</body>
</html>
